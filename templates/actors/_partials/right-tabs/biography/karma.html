<div class="SRBlockSheet">
	<ul>
		<li class="SR-LigneEnTete grid">
			<div class="col-12 SR-TextUppercase">{{localize 'SR5.CharacterEvolution'}}</div>
		</li>
		<li class="grid">
			<div class="col-2 SR-TextLeft {{#if (gt (lossModifiersSum data.karma) (gainModifiersSum data.karma))}}incomplete{{/if}}">{{localize 'SR5.KarmaCurrent'}}{{localize 'SR5.Colons'}}</div>
			<div class="col-2 SR-TextLeft">{{number (minus (gainModifiersSum data.karma) (lossModifiersSum data.karma))}}</div>
			<div class="col-2 SR-TextCenter">{{localize 'SR5.TotalGainedKarma'}}{{localize 'SR5.Colons'}}</div>
			<div class="col-2 SR-TextCenter">{{number (gainModifiersSum data.karma)}}</div>
			<div class="col-2 SR-TextRight">{{localize 'SR5.TotalSpentKarma'}}{{localize 'SR5.Colons'}}</div>
			<div class="col-2 SR-TextRight">{{number (lossModifiersSum data.karma)}}</div>
		</li>
	</ul>
</div>

<!-- PAST RUNS  -->
<div class="SRBlockSheet">
	<ul>
		<li class="SR-EnTete grid">
			<div class="col-9">
				<p class="filterKarmaGains SR-TextUppercase unfoldDark">{{localize 'SR5.PastRuns'}}</p>
			</div>
			<div class="col-2">
				<p class=" SR-TextCenterOverflow">{{localize 'SR5.KarmaGained'}}</p>
			</div>
			<div class="col-1">
				{{#if owner}}
				<p class="SR-TextRight add-item" data-helpTitle="{{localize 'SR5.HELP_ItemAdd' key=(localize 'SR5.PastRuns')}}"
				data-helpMessage="{{localize 'SR5.HELP_ItemAddMsg'}}">
					<a class="item-create" data-title="{{localize 'SR5.Add'}}" data-type="itemKarma" data-subtype="gain">
						<em class="fas fa-plus"></em>
					</a>
				</p>
				{{/if}}
			</div>
		</li>
		{{#each actor.karmas}}
		{{#ife data.type 'gain'}}
		<li class="item grid" data-item-id="{{_id}}" draggable="true">
			<div class="col-9">
				<p class="SR-PaddingRight3 {{#if (missing data.amount)}}incomplete{{/if}}"
				  data-helpTitle="{{localize 'SR5.HELP_KarmaGainName' key=name}}"
				  data-helpMessage="{{localize 'SR5.HELP_KarmaGainNameMsg'}}">
					<input data-item-id="{{_id}}" data-dtype="String" data-binding="name" type="text" class="edit-value" name="" value="{{name}}" onfocus="this.select()">
				</p>
			</div>
			<div class="col-2 SR-TextCenter"
				  data-helpTitle="{{localize 'SR5.KarmaGained'}}"
				  data-helpMessage="{{localize 'SR5.HELP_KarmaGainAmountMsg'}}">
				<input data-item-id="{{_id}}" data-dtype="Number" data-binding="data.amount" type="text" class="edit-value" name="" value="{{data.amount}}" onfocus="this.select()">
			</div>
			{{#if ../owner}}
			<div class="col-1 SR-TextRight">
				<a data-helpTitle="{{localize 'SR5.HELP_ItemManagement' key=name}}" data-helpMessage="{{localize 'SR5.HELP_ItemManagementMsg'}}">
					<em class="fas fa-sm fa-edit item-management"></em>
				</a>
			</div>
			{{/if}}
		</li>
		{{/ife}}
		{{/each}}
	</ul>
</div>

<!-- IMPROVEMENTS -->
<div class="SRBlockSheet">
	<ul>
		<li class="SR-EnTete grid">
			<div class="col-9">
				<p class="filterKarmaExpenses SR-TextUppercase unfoldDark">{{localize 'SR5.CharacterImprovements'}}</p>
			</div>
			<div class="col-2">
				<p class=" SR-TextCenterOverflow">{{localize 'SR5.KarmaSpent'}}</p>
			</div>
			<div class="col-1">
				{{#if owner}}
				<p class="SR-TextRight add-item"
				  data-helpTitle="{{localize 'SR5.HELP_ItemAdd' key=(localize 'SR5.CharacterImprovements')}}"
				  data-helpMessage="{{localize 'SR5.HELP_ItemAddMsg'}}">
					<a class="item-create" data-title="{{localize 'SR5.Add'}}" data-type="itemKarma" data-subtype="loss"><em class="fas fa-plus"></em></a>
				</p>
				{{/if}}
			</div>
		</li>
		{{#each actor.karmas}}
		{{#ife data.type 'loss'}}
		<li class="item grid" data-item-id="{{_id}}" draggable="true">
			<div class="col-9">
				<p class="SR-PaddingRight3 {{#if (missing data.amount)}}incomplete{{/if}}"
				  data-helpTitle="{{localize 'SR5.CharacterImprovements'}}"
				  data-helpMessage="{{localize 'SR5.HELP_CharacterImprovementsMsg'}}">
					<input data-item-id="{{_id}}" data-dtype="String" data-binding="name" type="text" class="edit-value" name="" value="{{name}}" onfocus="this.select()">
				</p>
			</div>
			<div class="col-2 SR-TextCenter"
				  data-helpTitle="{{localize 'SR5.KarmaSpent'}}"
				  data-helpMessage="{{localize 'SR5.HELP_KarmaSpentMsg'}}">
				<input data-item-id="{{_id}}" data-dtype="Number" data-binding="data.amount" type="text" class="edit-value" name="" value="{{data.amount}}" onfocus="this.select()">
			</div>
			{{#if ../owner}}
			<div class="col-1 SR-TextRight">
				<a data-helpTitle="{{localize 'SR5.HELP_ItemManagement' key=name}}" data-helpMessage="{{localize 'SR5.HELP_ItemManagementMsg'}}">
					<em class="fas fa-sm fa-edit item-management"></em>
				</a>
			</div>
			{{/if}}
		</li>
		{{/ife}}
		{{/each}}
	</ul>
</div>